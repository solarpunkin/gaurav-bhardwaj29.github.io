<!DOCTYPE html>
<html>
<head>
   <meta name="fediverse:creator" content="@wiredguy@mastodon.social">                  
  <link rel="stylesheet" href="../../weblog-style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function()  {
      if (window.renderMathInElement) {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
          ]
        });
      }
    });
  </script>
  <title>192.168.0.1</title>
</head>
<body>
<main>
  <h1>192.168.0.1</h1>
  <div class="weblog-body"><p>With the rapid depletion of IPv4 addresses, Network Address Translation (NAT) has become an essential component of modern networks. NAT allows multiple devices to share a single public IP address, enabling secure and efficient communication between private networks and the internet.</p>
<h2>IPv4 came out in the early 1980s</h2>
<h2>The young Internet lived in a world of mainframes</h2>
<ul>
<li>
<p>Many user terminals leashed to one central machine on the Internet</p>
</li>
<li>
<p>Personal microcomputers in the first generation, few modems even</p>
</li>
<li>
<p>Internet backbone ran only to advanced research facilities</p>
</li>
</ul>
<h2>Only researchers really cared about Internet resources</h2>
<h3>IPv4 uses 32-bit addresses: e.g., 134.10.2.45</h3>
<ul>
<li>Surely 4.2B addresses are enough!</li>
</ul>
<blockquote>
<p>"I think there is a world market for maybe five computers." 
– surely apocryphal remark attributed to Thomas Watson, chairman of IBM</p>
</blockquote>
<h2>By the early 1990s, the Internet had grown up</h2>
<figure style="text-align: center;">
  <img src="https://pub-91e1a485198740aabff1705e89606dc3.r2.dev/nat/rir-ipv4-status.png" style="max-width: 100%; height: auto;" />
  <figcaption>Current status of IPv4 address space. Source: https://ipv4.potaroo.net/</figcaption>
</figure>

<h2>Original assumptions of the Internet, defied</h2>
<ul>
<li>
<p>Now primarily a consumer tool, not a research tool</p>
</li>
<li>
<p>Internet became accessible through modems, then broadband and cellular</p>
</li>
<li>
<p>A clear path to billions of devices on the Internet</p>
</li>
<li>
<p>Devices are always on, always connected</p>
</li>
<li>
<p>No option other than increasing the address space</p>
</li>
</ul>
<h3>The IPng initiative</h3>
<ul>
<li>
<p>Undertaken by the IETF in the early 1990s (see <a href="https://www.rfc-editor.org/rfc/rfc1550">RFC1550</a>)</p>
</li>
<li>
<p>Led to IPv6 <a href="https://www.rfc-editor.org/rfc/rfc1883">RFC1883</a> published in December 1995, mature version in <a href="https://www.rfc-editor.org/rfc/rfc2460">RFC2460</a> December 1998
(What happened to IPv5, anyway? See ST-II <a href="https://www.rfc-editor.org/rfc/rfc1819">RFC1819</a>) </p>
</li>
</ul>
<h2>Virtues of IPv6</h2>
<h3>Plenty of addresses</h3>
<ul>
<li>
<p>340,282,366,920,938,463,463,374,607,431,768,211,456</p>
</li>
<li>
<p>That’s 128 bits, 340 undecillion or 3.4×1038</p>
</li>
<li>
<p>Grouped into /64s, blocks of 18 quintillion addresses</p>
</li>
<li>
<p>IPv6 fixes the network prefix at 64 bits</p>
</li>
<li>
<p>Enough addresses in a network that they can be chosen whimsically</p>
</li>
<li>2001:19f0:feee::dead:beef:cafe (freenode)</li>
<li>2001:420:80:1:c:15c0:d06:f00d (cisco)</li>
<li>2620::1c18:0:face:b00c:0:1 (facebook)</li>
</ul>
<h3>IPsec built-in from the start</h3>
<ul>
<li>Vint often remarks this was the greatest shortcoming of IPv4</li>
</ul>
<h3>However, a new standard can’t be introduced overnight</h3>
<p><em>What’s the interim strategy?</em></p>
<h2>Multiplexing an IP Address</h2>
<h3>IETF created “private” address space <a href="https://www.rfc-editor.org/rfc/rfc1918">RFC1918</a> (1996)</h3>
<ul>
<li>
<p>Most famously 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</p>
</li>
<li>
<p>Technically, the 172.16 block is 16 contiguous /16s, and the 192.168 block is 256 contiguous /24s</p>
</li>
</ul>
<h3>ip-masq in 1997</h3>
<ul>
<li>
<p>Allowed multiple computers to sit behind one modem’s Internet connection</p>
</li>
<li>
<p>Required application-layer gateway (ALG) for sophisticated features like FTP</p>
</li>
</ul>
<h3>Today the ubiquitous home “router” is mostly a Network Address Translator (NAT)</h3>
<ul>
<li>
<p>Has one public IP address on the WAN side, maps external ports to internal</p>
</li>
<li>
<p>Private addresses served via DHCP on the WiFi/Ethernet side</p>
</li>
<li>
<p>Your computer’s IP address has a good chance of being <em>192.168.0.1</em></p>
</li>
<li>
<p>If you can’t reach DHCP, then link-local autoconfiguration (169.254.0.0/16) <a href="https://www.rfc-editor.org/rfc/rfc3927">RFC3927</a></p>
</li>
<li>
<p>Implements various NAT, firewall and forwarding policies, supports many sorts of ALGs </p>
</li>
</ul>
<figure style="text-align: center;">
  <img src="https://pub-91e1a485198740aabff1705e89606dc3.r2.dev/nat/3-tier-world.jpeg" style="max-width: 100%; height: auto;" />
  <figcaption></figcaption>
</figure>

<h1>The Dark Bargain of NAT</h1>
<h3>Work by masking the address from which packets are sent</h3>
<ul>
<li>
<p>The NAT effectively hides the addresses behind it</p>
</li>
<li>
<p>Effectively firewalls the private network</p>
</li>
<li>
<p>However, recipients can’t distinguish endpoints behind the NAT</p>
</li>
</ul>
<h3>NATs optimize for client-server connections</h3>
<ul>
<li>Surfing, downloading, gaming</li>
</ul>
<h3>NATs interfere with asynchronous notifications</h3>
<ul>
<li>
<p>A NAT opens “pinholes” only when a client on the inside sends traffic out</p>
</li>
<li>
<p>When services on the outside want to send traffic in, you have a problem</p>
</li>
</ul>
<h3>NATs bungle rendez-vous protocols that require endpoints to know their own IP</h3>
<ul>
<li>
<p>A variety of workarounds have been developed to address this</p>
</li>
<li>
<p>These create real problems for peer-to-peer applications</p>
</li>
<li>Skype and BitTorrent are triumphs of engineering</li>
</ul>
<h3>Ultimately, strict conservation and NATs merely delayed the inevitable</h3>
<h3>Final IPv4 IANA assignment rule invoked Feb 3 2011</h3>
<ul>
<li>
<p>At that time, the five remaining /8s held by IANA were allocated, one each, to the RIRs</p>
</li>
<li>
<p>As of April 2011, APNIC already ran out</p>
</li>
<li>
<p>RIPE ran out on September 14, 2012</p>
</li>
<li>
<p>The rest will follow in the next couple years</p>
</li>
<li>Right now, ARIN &amp; LACNIC have 3 /8s left, AFRINIC has 4</li>
</ul>
<h2>Good thing IPv6 is here to pick up the slack! Right?</h2>

  <!-- Perlin noise image row (only for the perlin-noise post) -->
  
    <!-- simplex noise image row (only for the simplex-noise post) -->
  
  </div>
  <div class="weblog-date">Posted on 28 August 2025 (IST) · Follow me on <a href="https://x.com/wiredguys">Twitter</a> or <a rel="me" href="https://mastodon.social/@wiredguy">Mastodon</a></div>

  <ul class="weblog-list">
    <li><a href="../../index.html">&laquo; LOGS</a></li>
  </ul>
  <div class="weblog-sidebar">
    <h5>Jump to</h5>
    <ul>
      <li><a href="../ipc-stress-test/">&larr; Previous: how to find the fastest way to make systems talk</a></li>
    </ul>
  </div>
</main>
</body>
</html>
