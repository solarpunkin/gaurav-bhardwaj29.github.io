<!DOCTYPE html>
<html>
<head>
   <meta name="fediverse:creator" content="@wiredguy@mastodon.social">                  
  <link rel="stylesheet" href="../../weblog-style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function()  {
      if (window.renderMathInElement) {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false}
          ]
        });
      }
    });
  </script>
  <title>Custom browser picker on macOS with finicky</title>
</head>
<body>
<main>
  <h1>Custom browser picker on macOS with finicky</h1>
  <div class="weblog-body"><p>Many apps and links on macOS simply open in whatever browser is set as the default or last active, without offering a choice each time. By default, macOS uses the single system default browser (set in System Preferences/Settings) and does not prompt per-link. This means you might end up opening links repeatedly in the same browser even when you want to choose a different one.
I created a <strong>custom browser picker pop-up (aka kawaii)</strong> using <a href="https://github.com/johnste/finicky">Finicky</a>. This allows me to <strong>intercept link clicks</strong> and choose between browsers like Safari, Chrome, Firefox, and Brave — and even choose which browser profile to use — all from a native-looking UI.</p>
<hr />
<h2>kawaii UI</h2>
<figure style="text-align: center;">
  <img src="https://pub-91e1a485198740aabff1705e89606dc3.r2.dev/kawaii-ui.png" style="max-width: 100%; height: auto;" />
  <figcaption>Example custom pop-up dialog (AppleScript) for choosing a browser. The Finicky handler runs this script, captures the result, and opens the link in the chosen browser.</figcaption>
</figure>

<hr />
<h2>what I followed</h2>
<h3>1. <strong>install finicky</strong></h3>
<pre class="codehilite"><code class="language-bash">brew install --cask finicky
</code></pre>

<p>Then run it once manually to grant permissions(launch at login and default browser to intecept links and route them).</p>
<h3>2. <strong>write the <code>popup.sh</code></strong></h3>
<p>Create a script at <code>~/.config/kawaii/popup.sh</code>:</p>
<pre class="codehilite"><code class="language-bash">#!/bin/bash

# osascript to prompt for browser &amp; profile
CHOICE=$(osascript &lt;&lt;EOD
set browsers to {&quot;Safari&quot;, &quot;Chrome&quot;, &quot;Firefox&quot;, &quot;DuckDuckGo&quot;}
set browserChoice to choose from list browsers with prompt &quot;Choose your browser&quot; without multiple selections allowed
if browserChoice is false then
  return &quot;Safari&quot;
end if

set profiles to {&quot;Personal&quot;, &quot;Work&quot;}
set profileChoice to choose from list profiles with prompt &quot;Choose profile for &quot; &amp; item 1 of browserChoice without multiple selections allowed
if profileChoice is false then
  return item 1 of browserChoice
end if

return (item 1 of browserChoice) &amp; &quot; - &quot; &amp; (item 1 of profileChoice)
EOD
)

echo &quot;$CHOICE&quot;
</code></pre>

<p>Make it executable:</p>
<pre class="codehilite"><code class="language-bash">chmod +x ~/.config/kawaii/popup.sh
</code></pre>

<h3>3. <strong>create <code>finicky.js</code></strong></h3>
<pre class="codehilite"><code class="language-js">// ~/.finicky.js
export default {
  defaultBrowser: &quot;Safari&quot;,
  asyncBrowser: async (url) =&gt; {
    const result = await finicky.run({
      command: &quot;~/.config/kawaii/popup.sh&quot;
    })

    const choice = result.stdout.trim()

    switch (choice) {
      case &quot;Chrome - Personal&quot;:
        return { name: &quot;Google Chrome&quot;, profile: &quot;Gaurav&quot; }
      case &quot;Chrome - Work&quot;:
        return { name: &quot;Google Chrome&quot;, profile: &quot;spencer&quot; }
      case &quot;Firefox - Personal&quot;:
        return { name: &quot;Firefox&quot;, profile: &quot;personal&quot; }
      case &quot;Firefox - Work&quot;:
        return { name: &quot;Firefox&quot;, profile: &quot;work&quot; }
      case &quot;DuckDuckGo - Personal&quot;:
        return { name: &quot;DuckDuckGo&quot;, profile: &quot;personal&quot; }
      case &quot;DuckDuckGo - Work&quot;:
        return { name: &quot;DuckDuckGo&quot;, profile: &quot;work&quot; }
      case &quot;Safari&quot;:
      default:
        return &quot;Safari&quot;
    }
  }
}
</code></pre>

<p>In this setup, whenever Finicky intercepts a link, it runs the async browser function. The function calls our popup script via execSync, reads the chosen name, and returns it in an object <code>{name: "...", profile: "..."}</code> if needed. Finicky then launches that browser (and profile). If the user cancels, we return null to let Finicky use the default or do nothing. (Since Finicky v4, the browser function can be async and use modern syntax. We avoid any old legacy callbacks).</p>
<hr />
<h2>some walls i hit</h2>
<ul>
<li>
<p><strong>Validation error: <code>defaultBrowser</code> missing</strong><br />
    This must be set explicitly, even if you're overriding with <code>asyncBrowser</code>.</p>
</li>
<li>
<p><strong>No chooseBrowser API</strong> 
    Any mention of a built-in chooseBrowser is outdated. Finicky no longer provides a GUI chooser; we handle it ourselves via AppleScript.</p>
</li>
</ul>
<blockquote>
<p>Pro Tip: For more advanced UI, you can build your picker using tools like Raycast, Hammerspoon, or SwiftUI.</p>
</blockquote>
<hr />
<h2>orz</h2>
<ul>
<li><a href="https://github.com/johnste/finicky">Finicky GitHub Repo</a></li>
<li><a href="https://github.com/koekeishiya/yabai">Yabai</a></li>
</ul>

  <!-- Perlin noise image row (only for the perlin-noise post) -->
  
    <!-- simplex noise image row (only for the simplex-noise post) -->
  
  </div>
  <div class="weblog-date">Posted on 29 July 2025 (IST) · Follow me on <a href="https://x.com/wiredguys">Twitter</a> or <a rel="me" href="https://mastodon.social/@wiredguy">Mastodon</a></div>

  <ul class="weblog-list">
    <li><a href="../../index.html">&laquo; LOGS</a></li>
  </ul>
  <div class="weblog-sidebar">
    <h5>Jump to</h5>
    <ul>
      <li><a href="../iac-using-terraform-gcp/">Next: I wrote my first Infrastructure as Code &rarr;</a></li>
      <li><a href="../rss-feed/">&larr; Previous: Subscribe via RSS</a></li>
    </ul>
  </div>
</main>

<script>
function copyCode(button, preId) {
    const preElement = document.getElementById(preId);
    if (preElement) {
        const codeElement = preElement.querySelector('code');
        if (!codeElement) return;
        const codeText = codeElement.innerText;
        navigator.clipboard.writeText(codeText).then(() => {
            const originalContent = button.innerHTML;
            button.innerHTML = 'Copied!';
            button.disabled = true;
            setTimeout(() => {
                button.innerHTML = originalContent;
                button.disabled = false;
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy code: ', err);
            const originalContent = button.innerHTML;
            button.innerHTML = 'Error!';
            button.disabled = true;
            setTimeout(() => {
                button.innerHTML = originalContent;
                button.disabled = false;
            }, 2000);
        });
    }
}
</script>

</body>
</html>
